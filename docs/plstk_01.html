
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Un premier regard: La quantité probable de particules dans un polygone &#8212; Plast-Stock</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Un deuxième regard : effets du substrat, échantillonnage par région, données additionnelles, prévisions" href="plstk_02.html" />
    <link rel="prev" title="Plastock - count data" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Plast-Stock</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Plastock - count data
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Un premier regard: La quantité probable de particules dans un polygone
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plstk_02.html">
   Un deuxième regard : effets du substrat, échantillonnage par région, données additionnelles, prévisions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="references.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Built by <a href="https://hammerdirt.ch/">hammerdirt</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/hammerdirt-analyst/plastock/master?urlpath=tree/plstk_01.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/hammerdirt-analyst/plastock"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/plstk_01.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comptage-moyen-par-evenement-par-plage">
   Comptage moyen par événement par plage
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#toutes-variantes-confondues">
     Toutes variantes confondues.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comparaison-du-nombre-de-particules-trouvees-par-materiau-et-par-emplacement-sur-la-plage">
   Comparaison du nombre de particules trouvées par matériau et par emplacement sur la plage.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ligne-d-eau-et-arriere-de-la-plage">
   Ligne d’eau et arrière de la plage
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ligne-d-eau-comparee-a-la-plage-seche-tous-types-de-materiaux-et-plages-confondus">
   Ligne d’eau comparée à la plage-sèche tous types de matériaux et plages confondus.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-fonction-de-repartition">
   La fonction de répartition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modele-lineaire-generalise-mlg-glm">
   Modèle linéaire généralisé (MLG/GLM)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resultats-par-region-et-materiel">
     Résultats par région et matériel
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#intuition-ou-pourquoi-pas-la-regression-lineaire">
   Intuition (ou pourquoi pas la régression linéaire)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modele-continu-ou-discret">
   Modèle continu ou discret ?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#un-modele-discret">
   Un modèle discret
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#marginal-posterior-predictive-checks-leave-one-out-loo-probability-integral-transform-pit">
   Marginal posterior predictive checks: Leave One Out (LOO) Probability Integral Transform (PIT)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#probability-integral-transform">
     Probability Integral Transform
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#leave-one-out-cross-validation">
     Leave-One-Out Cross Validation:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#les-resultats-observes-et-prevus">
   Les résultats observés et prévus
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pieces-par-metre-carre">
   Pièces par mètre carré
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Un premier regard: La quantité probable de particules dans un polygone</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comptage-moyen-par-evenement-par-plage">
   Comptage moyen par événement par plage
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#toutes-variantes-confondues">
     Toutes variantes confondues.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comparaison-du-nombre-de-particules-trouvees-par-materiau-et-par-emplacement-sur-la-plage">
   Comparaison du nombre de particules trouvées par matériau et par emplacement sur la plage.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ligne-d-eau-et-arriere-de-la-plage">
   Ligne d’eau et arrière de la plage
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ligne-d-eau-comparee-a-la-plage-seche-tous-types-de-materiaux-et-plages-confondus">
   Ligne d’eau comparée à la plage-sèche tous types de matériaux et plages confondus.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-fonction-de-repartition">
   La fonction de répartition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modele-lineaire-generalise-mlg-glm">
   Modèle linéaire généralisé (MLG/GLM)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resultats-par-region-et-materiel">
     Résultats par région et matériel
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#intuition-ou-pourquoi-pas-la-regression-lineaire">
   Intuition (ou pourquoi pas la régression linéaire)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modele-continu-ou-discret">
   Modèle continu ou discret ?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#un-modele-discret">
   Un modèle discret
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#marginal-posterior-predictive-checks-leave-one-out-loo-probability-integral-transform-pit">
   Marginal posterior predictive checks: Leave One Out (LOO) Probability Integral Transform (PIT)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#probability-integral-transform">
     Probability Integral Transform
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#leave-one-out-cross-validation">
     Leave-One-Out Cross Validation:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#les-resultats-observes-et-prevus">
   Les résultats observés et prévus
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pieces-par-metre-carre">
   Pièces par mètre carré
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">import</span> <span class="nn">pymc</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="kn">import</span> <span class="nn">json</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="un-premier-regard-la-quantite-probable-de-particules-dans-un-polygone">
<h1>Un premier regard: La quantité probable de particules dans un polygone<a class="headerlink" href="#un-premier-regard-la-quantite-probable-de-particules-dans-un-polygone" title="Permalink to this headline">#</a></h1>
<p><em>doc version: 1, doc type: submission, doc title: A fist look, author: Roger Erismann, <a class="reference external" href="mailto:roger&#37;&#52;&#48;hammerdirt&#46;ch">roger<span>&#64;</span>hammerdirt<span>&#46;</span>ch</a></em></p>
<p>Ce document est destiné à tester la mise en œuvre de méthodes statistiques sur des données de comptage. Les données sont nettoyées dans une étape préalable. Le problème se résout autour des quantités relatives de 18 types de particules différentes (3 catégories de matériaux et 6 catégories de couleurs par matériau). Il y a des échantillons provenant de 25 plages différentes du Lac Léman.</p>
<p>Après discussion avec les chercheurs, les 18 particules différentes ont été combinées en deux catégories. Les matériaux ont été combinés car, au départ, les objets qui n’étaient pas des fibres étaient classés en fragments durs ou souples. Ainsi, les fragments comprennent à la fois des particules inorganiques souples et des particules inorganiques fragiles, qui ne sont pas des fibres.</p>
<ol class="simple">
<li><p>fibres</p></li>
<li><p>fragments (durs et souples)</p></li>
</ol>
<p>Les résultats pour tous les matériaux et la zone de plage sont examinés dans la section deux.</p>
<p><strong>Table des matières</strong></p>
<ol class="simple">
<li><p><a class="reference internal" href="#section-one-01"><span class="std std-ref">Moyen par événement par plage</span></a></p></li>
<li><p><a class="reference internal" href="#section-two-01"><span class="std std-ref">particules trouvées par matériau et par emplacement sur la plage.</span></a></p></li>
<li><p><a class="reference internal" href="#section-three-01"><span class="std std-ref">Comparaison de ligne d’eau et arrière de la plage</span></a></p></li>
<li><p><a class="reference internal" href="#section-four-01"><span class="std std-ref">La fonction de répartition (observé)</span></a></p></li>
<li><p><a class="reference internal" href="#section-five-01"><span class="std std-ref">Modèle linéaire généralisé (MLG/GLM)</span></a></p>
<ol class="simple">
<li><p>Les résultats par région et par matériau</p></li>
<li><p>Intuition (ou pourquoi pas la régression linéaire)</p></li>
<li><p>Le rapport entre les fragments et les fibres et le total.</p></li>
<li><p>Un modèle discret</p></li>
<li><p><a class="reference internal" href="#section-five-01-a"><span class="std std-ref">Vérifications de la distribution marginale postérieure</span></a></p>
<ol class="simple">
<li><p>posterior predictive checks</p></li>
<li><p>probability integral transform</p></li>
<li><p>leave one out cross validation</p></li>
<li><p>Observés et prévus, total par événement</p></li>
</ol>
</li>
</ol>
</li>
<li><p><a class="reference internal" href="#section-six"><span class="std std-ref">Pièces par mètre carré</span></a></p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first set of data</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/copy_of_asl.csv&quot;</span><span class="p">)</span>
<span class="n">c</span><span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># column groups by material type</span>
<span class="n">fibres</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fr&#39;</span><span class="p">,</span> <span class="s1">&#39;fb&#39;</span><span class="p">,</span> <span class="s1">&#39;fj&#39;</span><span class="p">,</span> <span class="s1">&#39;fw&#39;</span><span class="p">,</span> <span class="s1">&#39;fn&#39;</span><span class="p">,</span> <span class="s1">&#39;fa&#39;</span><span class="p">]</span>
<span class="n">fdure</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fdr&#39;</span><span class="p">,</span> <span class="s1">&#39;fdb&#39;</span><span class="p">,</span> <span class="s1">&#39;fdj&#39;</span><span class="p">,</span> <span class="s1">&#39;fdw&#39;</span><span class="p">,</span> <span class="s1">&#39;fdn&#39;</span><span class="p">,</span> <span class="s1">&#39;fda&#39;</span><span class="p">]</span>
<span class="n">souple</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fsr&#39;</span><span class="p">,</span> <span class="s1">&#39;fsb&#39;</span><span class="p">,</span> <span class="s1">&#39;fsj&#39;</span><span class="p">,</span> <span class="s1">&#39;fsw&#39;</span><span class="p">,</span> <span class="s1">&#39;fsn&#39;</span><span class="p">,</span> <span class="s1">&#39;fsa&#39;</span><span class="p">]</span>
<span class="n">fragments</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">fdure</span><span class="p">,</span> <span class="o">*</span><span class="n">souple</span><span class="p">]</span>

<span class="n">name_the_zones</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s2">&quot;ligne-d&#39;eau&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s2">&quot;plage-seche&quot;</span><span class="p">}</span>

<span class="c1"># the sum of all particles for one sample</span>
<span class="n">c</span><span class="p">[</span><span class="s2">&quot;added&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">[[</span><span class="o">*</span><span class="n">fragments</span><span class="p">,</span> <span class="o">*</span><span class="n">fibres</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># the sum of the different groups</span>
<span class="n">c</span><span class="p">[</span><span class="s2">&quot;fibres&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">fibres</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s2">&quot;fdure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">fdure</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s2">&quot;souple&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">souple</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">c</span><span class="p">[</span><span class="s2">&quot;fragments&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">fragments</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># the emplacement on the beach</span>
<span class="n">c</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">name_the_zones</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>

<span class="c1"># the samples where at least one particle was recorded</span>
<span class="n">cInventoryComplete</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">added</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cAdded</span> <span class="o">=</span> <span class="n">cInventoryComplete</span><span class="p">[[</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;fibres&quot;</span><span class="p">,</span> <span class="s2">&quot;fdure&quot;</span><span class="p">,</span> <span class="s2">&quot;souple&quot;</span><span class="p">,</span> <span class="s2">&quot;fragments&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># work columns</span>
<span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">]</span>
<span class="n">value_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;fibres&quot;</span><span class="p">,</span> <span class="s2">&quot;fdure&quot;</span><span class="p">,</span> <span class="s2">&quot;souple&quot;</span><span class="p">]</span>
<span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;p&quot;</span><span class="p">:</span><span class="s2">&quot;place&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">:</span><span class="s2">&quot;événement&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span><span class="s2">&quot;zone&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">:</span><span class="s2">&quot;substrat&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;variable&quot;</span><span class="p">:</span><span class="s2">&quot;matériel&quot;</span><span class="p">}</span>

<span class="c1"># make workdata to long form</span>
<span class="n">workData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">cAdded</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="n">id_vars</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="n">value_vars</span><span class="p">)</span>
<span class="n">workData</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cInventoryComplete</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;data/workDataOne.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># colors and styles</span>
<span class="n">zone_palette</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;plage-seche&quot;</span><span class="p">:</span><span class="s2">&quot;darkgoldenrod&quot;</span><span class="p">,</span><span class="s2">&quot;ligne-d&#39;eau&quot;</span><span class="p">:</span><span class="s2">&quot;lightseagreen&quot;</span><span class="p">}</span>
<span class="n">region_palette</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;GE&quot;</span><span class="p">:</span><span class="s2">&quot;darkgoldenrod&quot;</span><span class="p">,</span><span class="s2">&quot;VD&quot;</span><span class="p">:</span><span class="s2">&quot;lightseagreen&quot;</span><span class="p">}</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="comptage-moyen-par-evenement-par-plage">
<span id="section-one-01"></span><h2>Comptage moyen par événement par plage<a class="headerlink" href="#comptage-moyen-par-evenement-par-plage" title="Permalink to this headline">#</a></h2>
<section id="toutes-variantes-confondues">
<h3>Toutes variantes confondues.<a class="headerlink" href="#toutes-variantes-confondues" title="Permalink to this headline">#</a></h3>
<p>Le nombre moyen pour chaque événement variait de 19 à 180 fragments par échantillon de 5 X 10 X 10 cm. Les événements pour lesquels aucun compte n’a été rapporté ont été retirés de ce test.</p>
<p><strong>Note</strong> Ces chiffres sont-ils complets ? Certains semblent très bas ou toutes les particules n’ont pas encore été comptées ?</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a_df</span><span class="o">=</span> <span class="n">workData</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;événement&quot;</span><span class="p">,</span> <span class="s2">&quot;place&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">a_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;place&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;place&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">dodge</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Fragments&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">.08</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;La distribution du nombre de fragments par événement et par plage.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.9</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plstk_01_4_0.png" src="_images/plstk_01_4_0.png" />
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Le nombre moyen de particules par événement tous les sites et matériaux

NOTE: mean = moyen, count=nombre d&#39;événements, std=écart type

count     96.000000
mean     114.822917
std       82.129038
min       19.000000
25%       57.750000
50%       95.000000
75%      143.000000
max      481.000000
Name: y, dtype: float64 
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 
Le nombre moyen de particules par événement et par plage

place
Aubonne         66.833333
Baby Plage      90.875000
Bouveret        90.857143
Clarens         54.250000
Crans           19.000000
Cully          128.000000
Gland           40.000000
Grangettes      99.000000
Hermance        66.500000
Lutry           77.000000
Pichette        72.000000
Préverenges    179.117647
Rolle          153.761905
Savonière      130.000000
Tolochenaz      95.750000
Tougues         51.000000
Versoix         99.750000
Vidy            78.166667
Name: y, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="comparaison-du-nombre-de-particules-trouvees-par-materiau-et-par-emplacement-sur-la-plage">
<span id="section-two-01"></span><h2>Comparaison du nombre de particules trouvées par matériau et par emplacement sur la plage.<a class="headerlink" href="#comparaison-du-nombre-de-particules-trouvees-par-materiau-et-par-emplacement-sur-la-plage" title="Permalink to this headline">#</a></h2>
<p>Même s’il semble qu’il y ait plus de particules sur la plage-sèche, cela peut être dû à quelques événements seulement. Le matériau souple a été identifié le moins souvent, et cela semble se généraliser à tous les événements.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a_df</span><span class="o">=</span> <span class="n">workData</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;événement&quot;</span><span class="p">,</span><span class="s2">&quot;zone&quot;</span><span class="p">,</span> <span class="s2">&quot;matériel&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">a_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;événement&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;zone&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">zone_palette</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;matériel&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Événement&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Fragments&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>

<span class="n">axOne</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">a_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;matériel&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;zone&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">zone_palette</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axOne</span><span class="p">,</span> <span class="n">dodge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axOne</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">axOne</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">axOne</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">axOne</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.9</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Comparaison entre le type de matériel le ligne d&#39;eau et le fond de la plage. &quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.98</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plstk_01_8_0.png" src="_images/plstk_01_8_0.png" />
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 
Le nombre moyen de particules par zone et matériel

          zone matériel           y
0  ligne-d&#39;eau    fdure   14.319444
1  ligne-d&#39;eau   fibres   79.541667
2  ligne-d&#39;eau   souple    2.930556
3  plage-seche    fdure   37.041667
4  plage-seche   fibres  128.083333
5  plage-seche   souple    3.791667
</pre></div>
</div>
</div>
</div>
</section>
<section id="ligne-d-eau-et-arriere-de-la-plage">
<span id="section-three-01"></span><h2>Ligne d’eau et arrière de la plage<a class="headerlink" href="#ligne-d-eau-et-arriere-de-la-plage" title="Permalink to this headline">#</a></h2>
<p>On peut voir ici que les valeurs de la plage-sèche ne proviennent que de quelques endroits. Nous allons attendre jusqu’à ce que les comptages arrivent pour ces endroits.</p>
<p>Cependant, les méthodes d’analyse peuvent toujours être testées sur les données de la ligne d’eau. Nous allons également combiner le matériel fragmenté en un seul groupe “fragments”.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a_df</span> <span class="o">=</span> <span class="n">workData</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;événement&quot;</span><span class="p">,</span><span class="s2">&quot;place&quot;</span><span class="p">,</span><span class="s2">&quot;zone&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">a_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;place&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;zone&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">zone_palette</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">dodge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Fibres + fragments&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;La distribution du nombre de fragments (fibres + fragments) de chaque plage.</span><span class="se">\n</span><span class="s2">Comparaison entre la ligne d&#39;eau et le fond de la plage. &quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.9</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plstk_01_11_0.png" src="_images/plstk_01_11_0.png" />
</div>
</div>
</section>
<section id="ligne-d-eau-comparee-a-la-plage-seche-tous-types-de-materiaux-et-plages-confondus">
<h2>Ligne d’eau comparée à la plage-sèche tous types de matériaux et plages confondus.<a class="headerlink" href="#ligne-d-eau-comparee-a-la-plage-seche-tous-types-de-materiaux-et-plages-confondus" title="Permalink to this headline">#</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">a_df</span><span class="p">[[</span><span class="s2">&quot;zone&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]],</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;zone&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;zone&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">zone_palette</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">dodge</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Fibres + fragments&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;La distribution du nombre de fragments (fibres + fragments).</span><span class="se">\n</span><span class="s2">Comparaison entre la ligne d&#39;eau et le fond de la plage.&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.9</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plstk_01_13_0.png" src="_images/plstk_01_13_0.png" />
</div>
</div>
</section>
<section id="la-fonction-de-repartition">
<span id="section-four-01"></span><h2>La fonction de répartition<a class="headerlink" href="#la-fonction-de-repartition" title="Permalink to this headline">#</a></h2>
<p>Même s’il y a un nombre différent d’échantillons et quelques valeurs extrêmes. Les deux zones de plage ont des distributions cumulatives très similaires.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">ecdfplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">workData</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>  <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;zone&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">zone_palette</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">workData</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>  <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;zone&quot;</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">zone_palette</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;probabilité&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;probabilité&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Fibres + fragments&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Fibres + fragments&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plstk_01_15_0.png" src="_images/plstk_01_15_0.png" />
</div>
</div>
</section>
<section id="modele-lineaire-generalise-mlg-glm">
<span id="section-five-01"></span><h2>Modèle linéaire généralisé (MLG/GLM)<a class="headerlink" href="#modele-lineaire-generalise-mlg-glm" title="Permalink to this headline">#</a></h2>
<p>Il y a plus d’échantillons de la ligne d’eau que de la plage sèche. Notez également qu’indépendamment de l’emplacement sur la plage, les fragments souples ne représentent qu’une faible proportion de tous les fragments. Pour ces raisons, dans les modèles suivants, nous ne considérons que les échantillons de la ligne d’eau. Les deux catégories de fragments (souples, durs) sont combinées en un seul groupe appelé fragments.</p>
<p>Note : Parmi les échantillons dont le total est supérieur à zéro, 49 proviennent du canton de Vaud (VD), 15 du canton de Genève (GE). Il y a un échantillon de Haute Savoie (74) et sept du Valais (VS). Par conséquent, nous ne considérons que les régions qui ont le plus grand nombre d’échantillons : VD, GE.</p>
<section id="resultats-par-region-et-materiel">
<h3>Résultats par région et matériel<a class="headerlink" href="#resultats-par-region-et-materiel" title="Permalink to this headline">#</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># combine the fibres and fragments</span>
<span class="n">cAdded</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cAdded</span><span class="p">[[</span><span class="s2">&quot;fibres&quot;</span><span class="p">,</span> <span class="s2">&quot;fragments&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">cAdded</span><span class="o">.</span><span class="n">z</span> <span class="o">==</span> <span class="s2">&quot;ligne-d&#39;eau&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">cAdded</span><span class="o">.</span><span class="n">total</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">cData</span>  <span class="o">=</span> <span class="n">cAdded</span><span class="p">[</span><span class="n">mask</span><span class="p">][[</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span><span class="s2">&quot;fibres&quot;</span><span class="p">,</span> <span class="s2">&quot;fragments&quot;</span><span class="p">,</span> <span class="s2">&quot;total&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># make city and region abbreviations from place and event columns</span>
<span class="n">cData</span><span class="p">[</span><span class="s2">&quot;city&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cData</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<span class="n">cData</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cData</span><span class="o">.</span><span class="n">E</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

<span class="c1"># limit data to the regions with the most samples</span>
<span class="n">cDataT</span> <span class="o">=</span> <span class="n">cData</span><span class="p">[</span><span class="n">cData</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;GE&quot;</span><span class="p">,</span> <span class="s2">&quot;VD&quot;</span><span class="p">])]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cDataT</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cDataT</span> <span class="o">=</span> <span class="n">cDataT</span><span class="p">[[</span><span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;fibres&quot;</span><span class="p">,</span> <span class="s2">&quot;fragments&quot;</span><span class="p">,</span> <span class="s2">&quot;total&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># put data to long form</span>
<span class="n">cMelted</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">cDataT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fibres&quot;</span><span class="p">,</span> <span class="s2">&quot;fragments&quot;</span><span class="p">,])</span>
<span class="n">cMelted</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cMelted</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Les résultats par région et par matériau</span><span class="se">\n</span><span class="s2">Genève et Vaud seulement, fragments = souple + dur&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plstk_01_18_0.png" src="_images/plstk_01_18_0.png" />
</div>
</div>
</section>
</section>
<section id="intuition-ou-pourquoi-pas-la-regression-lineaire">
<h2>Intuition (ou pourquoi pas la régression linéaire)<a class="headerlink" href="#intuition-ou-pourquoi-pas-la-regression-lineaire" title="Permalink to this headline">#</a></h2>
<p>La régression linéaire ordinaire prédit la valeur attendue d’une quantité inconnue donnée (la variable de réponse, une variable aléatoire) comme une combinaison linéaire d’un ensemble de valeurs observées (prédicteurs). Cela implique qu’une variation constante d’un prédicteur entraîne une variation constante de la variable de réponse (c’est-à-dire un modèle de réponse linéaire). Cette hypothèse est appropriée lorsque la variable de réponse peut varier, en bonne approximation, indéfiniment dans un sens ou dans l’autre, ou plus généralement pour toute quantité qui ne varie que d’une quantité relativement faible par rapport à la variation des variables prédictives, par exemple les hauteurs humaines.</p>
<p>Cependant, ces hypothèses sont inappropriées pour certains types de variables de réponse. Par exemple, dans les cas où l’on s’attend à ce que la variable de réponse soit toujours positive (notre cas) et varie sur une large plage, des changements d’entrée constants conduisent à des changements de sortie à variation géométrique (c’est-à-dire exponentielle), plutôt qu’à variation constante. À titre d’exemple, supposons qu’un modèle de prédiction linéaire apprenne, à partir de certaines données (peut-être principalement tirées de grandes plages), qu’une baisse de température de 10 degrés entraînerait une diminution de 1 000 personnes de la fréquentation de la plage. Il est peu probable que ce modèle se généralise bien sur des plages de tailles différentes. Plus précisément, le problème est que si vous utilisez le modèle pour prédire la nouvelle fréquentation avec une baisse de température de 10 pour une plage qui reçoit régulièrement 50 plagistes, vous prédire une valeur de fréquentation impossible de -950. Logiquement, un modèle plus réaliste prévoirait plutôt un taux constant d’augmentation de la fréquentation des plages (par exemple, une augmentation de 10 degrés entraîne un doublement de la fréquentation des plages, et une baisse de 10 degrés entraîne une diminution de moitié de la fréquentation). Un tel modèle est appelé modèle à réponse exponentielle (ou modèle log-linéaire, puisque le logarithme de la réponse est censé varier linéairement).  <a class="reference external" href="https://fr.wikipedia.org/wiki/Mod%C3%A8le_lin%C3%A9aire_g%C3%A9n%C3%A9ralis%C3%A9">wikepedia</a></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">cData</span><span class="o">.</span><span class="n">fibres</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">cData</span><span class="o">.</span><span class="n">fragments</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>  <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">cData</span><span class="o">.</span><span class="n">total</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>  <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Fibres&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Fragments&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Total&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Compte&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Les composantes du GLM fibres + fragments = total.&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plstk_01_20_0.png" src="_images/plstk_01_20_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cData</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;fibres&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cData</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;fragments&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cData</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;fragments&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;fibres&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;total/fragments&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;total/fibres&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;fibres/fragments&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Comparer le rapport entre les fragments et les fibres et le total.&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plstk_01_21_0.png" src="_images/plstk_01_21_0.png" />
</div>
</div>
</section>
<section id="modele-continu-ou-discret">
<h2>Modèle continu ou discret ?<a class="headerlink" href="#modele-continu-ou-discret" title="Permalink to this headline">#</a></h2>
<p>Un échantillon est le contenu d’un polygone de 500 cm³. Ce qui signifie qu’il peut être considéré sous la forme compte/500, ou le taux de fragments par 500cm³. <strong>Nous allons considérerons le cas, discret</strong>. En d’autres termes, les échantillons sont considérés comme une série d’expériences indépendantes et et identiquement distribuée <a class="reference external" href="https://en.wikipedia.org/wiki/Independent_and_identically_distributed_random_variables">(IID)</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>

<span class="c1"># référence pour indexer les valeurs des résultats observés aux prédictions du modèle. </span>
<span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;component&quot;</span><span class="p">:</span><span class="n">comp_labels</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">rlabels</span><span class="p">,</span> <span class="s2">&quot;obs_id&quot;</span><span class="p">:</span><span class="n">cMelted</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">}</span>

<span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span> <span class="k">as</span> <span class="n">glmNegativeBinomialRegion</span><span class="p">:</span>
    
    <span class="c1"># cela indexe les résultats observés aux valeurs calculées    </span>
    <span class="n">region_idx</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="s2">&quot;regions&quot;</span><span class="p">,</span> <span class="n">regions</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;obs_id&quot;</span><span class="p">,</span> <span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">comp_idx</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="s2">&quot;components&quot;</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;obs_id&quot;</span><span class="p">,</span> <span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">observed</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">ConstantData</span><span class="p">(</span><span class="s2">&quot;obs&quot;</span><span class="p">,</span> <span class="n">cMelted</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;obs_id&quot;</span><span class="p">)</span>
    
    <span class="c1"># la proposition de répartition des résultats par région</span>
    <span class="n">region</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">)</span>
    <span class="c1"># la proposition de répartition des résultats par matériel</span>
    <span class="n">comp</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;component&quot;</span><span class="p">)</span>
    
    <span class="c1"># les paramètre d&#39;intérêt      </span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Deterministic</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="n">comp</span><span class="p">[</span><span class="n">comp_idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">comp</span><span class="p">[</span><span class="n">comp_idx</span><span class="p">]</span><span class="o">*</span><span class="n">region</span><span class="p">[</span><span class="n">region_idx</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;obs_id&quot;</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>    
    
    <span class="c1"># le résultat de ce calcul est la distribution postérieure</span>
    <span class="n">found</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">NegativeBinomial</span><span class="p">(</span><span class="s2">&quot;found&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">pm</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">observed</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="un-modele-discret">
<h2>Un modèle discret<a class="headerlink" href="#un-modele-discret" title="Permalink to this headline">#</a></h2>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">components</span><span class="p">,</span> <span class="n">comp_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">factorize</span><span class="p">(</span><span class="n">cMelted</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>
<span class="n">regions</span><span class="p">,</span> <span class="n">rlabels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">factorize</span><span class="p">(</span><span class="n">cMelted</span><span class="o">.</span><span class="n">region</span><span class="p">)</span>

<span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;component&quot;</span><span class="p">:</span><span class="n">comp_labels</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">rlabels</span><span class="p">,</span> <span class="s2">&quot;obs_id&quot;</span><span class="p">:</span><span class="n">cMelted</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">}</span>

<span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span> <span class="k">as</span> <span class="n">glmNegativeBinomialRegion</span><span class="p">:</span>
    
    <span class="n">region_idx</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="s2">&quot;regions&quot;</span><span class="p">,</span> <span class="n">regions</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;obs_id&quot;</span><span class="p">,</span> <span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">comp_idx</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="s2">&quot;components&quot;</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;obs_id&quot;</span><span class="p">,</span> <span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">observed</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">ConstantData</span><span class="p">(</span><span class="s2">&quot;obs&quot;</span><span class="p">,</span> <span class="n">cMelted</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;obs_id&quot;</span><span class="p">)</span>
    
    <span class="n">region</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">)</span>    
    <span class="n">comp</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;component&quot;</span><span class="p">)</span>
        
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Deterministic</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="n">comp</span><span class="p">[</span><span class="n">comp_idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">comp</span><span class="p">[</span><span class="n">comp_idx</span><span class="p">]</span><span class="o">*</span><span class="n">region</span><span class="p">[</span><span class="n">region_idx</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;obs_id&quot;</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>    
    
    <span class="n">found</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">NegativeBinomial</span><span class="p">(</span><span class="s2">&quot;found&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">pm</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">observed</span><span class="p">)</span>

<span class="k">with</span> <span class="n">glmNegativeBinomialRegion</span><span class="p">:</span>
    <span class="n">stwo</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
    <span class="n">pst</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample_posterior_predictive</span><span class="p">(</span><span class="n">stwo</span><span class="p">)</span>
    <span class="n">stwo</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pst</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">stwo</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;stats&quot;</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>r[GE]</th>
      <td>3.114286</td>
      <td>1.508325</td>
      <td>1.437636</td>
      <td>6.560062</td>
    </tr>
    <tr>
      <th>r[VD]</th>
      <td>3.781043</td>
      <td>1.558930</td>
      <td>1.705742</td>
      <td>8.697190</td>
    </tr>
    <tr>
      <th>c[fibres]</th>
      <td>7.330179</td>
      <td>1.474030</td>
      <td>3.773489</td>
      <td>15.332887</td>
    </tr>
    <tr>
      <th>c[fragments]</th>
      <td>3.640059</td>
      <td>1.290462</td>
      <td>2.332638</td>
      <td>5.800824</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="marginal-posterior-predictive-checks-leave-one-out-loo-probability-integral-transform-pit">
<span id="section-five-01-a"></span><h2>Marginal posterior predictive checks: Leave One Out (LOO) Probability Integral Transform (PIT)<a class="headerlink" href="#marginal-posterior-predictive-checks-leave-one-out-loo-probability-integral-transform-pit" title="Permalink to this headline">#</a></h2>
<p>Traduit d’ici: <a class="reference external" href="https://oriolabrilpla.cat/python/arviz/pymc3/2019/07/31/loo-pit-tutorial.html">https://oriolabrilpla.cat/python/arviz/pymc3/2019/07/31/loo-pit-tutorial.html</a></p>
<p>L’un des piliers de la statistique bayésienne consiste à travailler avec la distribution postérieure des paramètres au lieu d’utiliser des estimations ponctuelles et des erreurs ou des intervalles de confiance. Nous savons tous comment obtenir cette distribution postérieure compte tenu de la vraisemblance (likelihood) , de l’information apriori (prior information) :
<strong>p(y<sup>∗</sup>∣y)=∫p(y<sup>∗</sup>∣θ)p(θ∣y)dθ</strong>.</p>
<p>Où y∗ est la donnée non observée possible et y est la donnée observée. Par conséquent, si notre modèle est correct, les données observées et le prédictif postérieur suivent la même fonction de densité de probabilité (pdf) ou fonction de mass de probabilité (pmf). Afin de vérifier si cela est vrai, il est courant d’effectuer des contrôles de prédiction postérieure en comparant la prédiction postérieure aux données observées.</p>
<p>Une autre alternative consiste à effectuer des vérifications LOO-PIT, qui sont une sorte de vérifications prédictives postérieures marginales. Marginaux parce que nous comparons chaque observation uniquement avec les échantillons prédictifs postérieurs correspondants au lieu de combiner toutes les observations et tous les échantillons prédictifs postérieurs. Comme son nom l’indique, cette méthode combine deux concepts différents, la validation croisée Leave-One-Out et la transformation intégrale des probabilités.</p>
<section id="probability-integral-transform">
<h3>Probability Integral Transform<a class="headerlink" href="#probability-integral-transform" title="Permalink to this headline">#</a></h3>
<p>La démonstration mathématique peut être trouvée sur <a class="reference external" href="https://en.wikipedia.org/wiki/Probability_integral_transform">wikipedia</a>. Cependant, ici, au lieu de la reproduire, je vais essayer d’exposer l’intuition derrière ce fait. On peut l’imaginer avec les échantillons postérieurs d’une exécution MCMC. Si nous disposons d’un nombre suffisant d’échantillons, la probabilité qu’un nouvel échantillon se situe entre les deux plus petites valeurs sera la même que la probabilité qu’un nouvel échantillon se situe entre les deux valeurs les plus proches de la médiane.</p>
<p>Ceci est dû au fait que la probabilité autour des plus petites valeurs sera plus faible, mais elles seront plus éloignées, alors que la probabilité autour de la médiane sera plus grande mais elles seront extrêmement proches. Ces deux effets se compensent et la probabilité est bien la même. Ainsi, la probabilité est constante indépendamment du carré dans lequel le nouvel échantillon tomberait, ce qui n’est compatible qu’avec une distribution uniforme.</p>
</section>
<section id="leave-one-out-cross-validation">
<h3>Leave-One-Out Cross Validation:<a class="headerlink" href="#leave-one-out-cross-validation" title="Permalink to this headline">#</a></h3>
<p>La validation croisée est une façon d’essayer de résoudre le problème de toutes les données futures que j’ai mentionnées jusqu’à présent. Nous ne disposons pas de ces données futures, alors comment sommes-nous censés faire des calculs avec elles ? La validation croisée résout ce problème en divisant les données observées en KK sous-ensembles, en excluant un sous-ensemble des données utilisées pour ajuster le modèle (il s’agit donc de données inconnues du modèle, c’est-à-dire de données futures), puis en utilisant ce sous-ensemble exclu comme données futures. En général, pour obtenir de meilleurs résultats, ce processus est effectué K fois, en excluant un sous-ensemble différent à chaque fois.</p>
<p>LOO-CV est un cas particulier où le nombre de sous-ensembles est égal au nombre d’observations, de sorte qu’à chaque itération, une seule observation est exclue. En d’autres termes, nous ajustons le modèle une fois par observation en excluant uniquement cette observation.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># excellent article from a developer at PyMC</span>
<span class="c1"># https://oriolabrilpla.cat/python/arviz/pymc/xarray/2022/06/07/pymc-arviz.html</span>

<span class="k">def</span> <span class="nf">plot_ppc_loopit</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>    
    <span class="n">ax_ppc</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">);</span> 
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
    <span class="n">az</span><span class="o">.</span><span class="n">plot_ppc</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_ppc</span><span class="p">);</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ecdf</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">],</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)):</span>
        <span class="n">az</span><span class="o">.</span><span class="n">plot_loo_pit</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;found&quot;</span><span class="p">,</span> <span class="n">ecdf</span><span class="o">=</span><span class="n">ecdf</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
    <span class="n">ax_ppc</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax_ppc</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ax_ppc</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">])</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">plot_ppc_loopit</span><span class="p">(</span><span class="n">stwo</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="s2">&quot;Posterior predictive checks&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Leave One Out (LOO) and Probability Integral Transform (PIT)&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.98</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plstk_01_27_0.png" src="_images/plstk_01_27_0.png" />
</div>
</div>
<p><strong>Interpretation</strong>: Les valeurs observées sont similaires aux valeurs prédictives postérieures superposées (graphique du haut). Il en va de même pour les valeurs de LOO-PIT (en bas à gauche). Cependant, la différence entre la fonction de répartion empirique (ECDF) et la CDF uniforme idéale peut présenter un léger biais étant donné que la ligne pousse vers l’extrémité inférieure de l’enveloppe crédible de 94 %.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># split the observed data into regions</span>
<span class="n">ge</span> <span class="o">=</span> <span class="n">cMelted</span><span class="p">[</span><span class="n">cMelted</span><span class="o">.</span><span class="n">region</span> <span class="o">==</span> <span class="s2">&quot;GE&quot;</span><span class="p">]</span>
<span class="n">vd</span> <span class="o">=</span> <span class="n">cMelted</span><span class="p">[</span><span class="n">cMelted</span><span class="o">.</span><span class="n">region</span> <span class="o">==</span> <span class="s2">&quot;VD&quot;</span><span class="p">]</span>

<span class="c1"># get the index number for each record type</span>
<span class="c1"># geneva index fibers and fragments</span>
<span class="n">geFindex</span> <span class="o">=</span> <span class="n">ge</span><span class="p">[</span><span class="n">ge</span><span class="o">.</span><span class="n">variable</span> <span class="o">==</span> <span class="s2">&quot;fragments&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">geFbrsIndex</span> <span class="o">=</span> <span class="n">ge</span><span class="p">[</span><span class="n">ge</span><span class="o">.</span><span class="n">variable</span> <span class="o">==</span> <span class="s2">&quot;fibres&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="c1"># vaud index fibers and fragments</span>
<span class="n">vdFindex</span> <span class="o">=</span> <span class="n">vd</span><span class="p">[</span><span class="n">vd</span><span class="o">.</span><span class="n">variable</span> <span class="o">==</span> <span class="s2">&quot;fragments&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span> 
<span class="n">vdFbrsIndex</span> <span class="o">=</span> <span class="n">vd</span><span class="p">[</span><span class="n">vd</span><span class="o">.</span><span class="n">variable</span> <span class="o">==</span> <span class="s2">&quot;fibres&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># retrieve the posterior predictive samples with the same index</span>
<span class="c1"># geneva</span>
<span class="n">ai</span> <span class="o">=</span> <span class="n">stwo</span><span class="o">.</span><span class="n">posterior_predictive</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="s1">&#39;found_dim_0&#39;</span><span class="p">:</span><span class="n">geFindex</span><span class="p">})</span><span class="o">.</span><span class="n">found</span><span class="o">.</span><span class="n">values</span>
<span class="n">bi</span> <span class="o">=</span> <span class="n">stwo</span><span class="o">.</span><span class="n">posterior_predictive</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="s1">&#39;found_dim_0&#39;</span><span class="p">:</span><span class="n">geFbrsIndex</span><span class="p">})</span><span class="o">.</span><span class="n">found</span><span class="o">.</span><span class="n">values</span>
<span class="c1"># vaud</span>
<span class="n">ci</span> <span class="o">=</span> <span class="n">stwo</span><span class="o">.</span><span class="n">posterior_predictive</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="s1">&#39;found_dim_0&#39;</span><span class="p">:</span><span class="n">vdFindex</span><span class="p">})</span><span class="o">.</span><span class="n">found</span><span class="o">.</span><span class="n">values</span>
<span class="n">di</span> <span class="o">=</span> <span class="n">stwo</span><span class="o">.</span><span class="n">posterior_predictive</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="s1">&#39;found_dim_0&#39;</span><span class="p">:</span><span class="n">vdFbrsIndex</span><span class="p">})</span><span class="o">.</span><span class="n">found</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># combine the fibres and fragments</span>
<span class="n">pp_found</span> <span class="o">=</span> <span class="n">ai</span> <span class="o">+</span> <span class="n">bi</span> <span class="c1"># geneva</span>
<span class="n">pp_found_ravel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">pp_found</span><span class="p">)</span>

<span class="n">pp_foundvd</span> <span class="o">=</span> <span class="n">ci</span> <span class="o">+</span> <span class="n">di</span> <span class="c1"># vaud</span>
<span class="n">pp_found_ravelvd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">pp_foundvd</span><span class="p">)</span>

<span class="c1"># save the posterior predictive samples for this example to .JSON</span>
<span class="k">def</span> <span class="nf">saveToJson</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">afile</span><span class="p">)</span>
        
<span class="n">geneva_posterior</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;data/fibersGePosteriorPredictive.json&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">bi</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()],</span>
    <span class="p">[</span><span class="s2">&quot;data/fragmentsGePosteriorPredictive.json&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">ai</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()],</span>
    <span class="p">[</span><span class="s2">&quot;data/totalGePosteriorPredictive.json&quot;</span><span class="p">,</span> <span class="n">pp_found_ravel</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">apair</span> <span class="ow">in</span> <span class="n">geneva_posterior</span><span class="p">:</span>
    <span class="n">saveToJson</span><span class="p">(</span><span class="n">apair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">apair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">vaud_posterior</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;data/fragmentsVdPosteriorPredictive.json&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">ci</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()],</span>
    <span class="p">[</span><span class="s2">&quot;data/fibersVdPosteriorPredictive.json&quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">di</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()],</span>
    <span class="p">[</span><span class="s2">&quot;data/totalVdPosteriorPredictive.json&quot;</span><span class="p">,</span> <span class="n">pp_found_ravelvd</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">apair</span> <span class="ow">in</span> <span class="n">vaud_posterior</span><span class="p">:</span>
    <span class="n">saveToJson</span><span class="p">(</span><span class="n">apair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">apair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">bi</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">pp_found_ravel</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;posterior predictive&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">ai</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">pp_found_ravel</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">ai</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">bi</span><span class="p">),</span>  <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cData</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;fibres&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;observed&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cData</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;fragments&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cData</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;fragments&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;fibres&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;total/fragments&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;total/fibres&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;fibres/fragments&quot;</span><span class="p">)</span>

<span class="n">h</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Comparer le rapport entre les fragments et les fibres et le total.&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span> <span class="mf">.84</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plstk_01_30_0.png" src="_images/plstk_01_30_0.png" />
</div>
</div>
</section>
</section>
<section id="les-resultats-observes-et-prevus">
<h2>Les résultats observés et prévus<a class="headerlink" href="#les-resultats-observes-et-prevus" title="Permalink to this headline">#</a></h2>
<p>Les résultats de VS et HS se situent dans le 90ème percentile de GE. Cela suggère que les échantillons de ces régions se situent dans la distribution prédite de GE ainsi que dans la distribution combinée pour le lac.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get random samples from the posterior predictive:</span>
<span class="n">pSampsg</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">pp_found_ravel</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span> <span class="c1"># geneva</span>
<span class="n">pSampsvd</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">pp_found_ravelvd</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span> <span class="c1"># vaud</span>

<span class="c1"># get the observed values</span>
<span class="n">priorvd</span> <span class="o">=</span> <span class="n">cData</span><span class="p">[</span><span class="n">cData</span><span class="o">.</span><span class="n">region</span> <span class="o">==</span> <span class="s2">&quot;VD&quot;</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">priorg</span> <span class="o">=</span> <span class="n">cData</span><span class="p">[</span><span class="n">cData</span><span class="o">.</span><span class="n">region</span> <span class="o">==</span> <span class="s2">&quot;GE&quot;</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># get the samples not in VD or GE:</span>
<span class="n">vs_hs</span> <span class="o">=</span> <span class="n">cData</span><span class="p">[</span><span class="n">cData</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;VS&quot;</span><span class="p">,</span> <span class="s2">&quot;74&quot;</span><span class="p">])]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">vs_hs</span> <span class="o">=</span> <span class="n">vs_hs</span><span class="p">[[</span><span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;fibres&quot;</span><span class="p">,</span> <span class="s2">&quot;fragments&quot;</span><span class="p">,</span> <span class="s2">&quot;total&quot;</span><span class="p">]]</span>

<span class="c1"># boxplots need to have the rgba:</span>
<span class="n">rgba_ge</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="s2">&quot;darkgoldenrod&quot;</span><span class="p">)</span>
<span class="n">rgba_ge</span> <span class="o">=</span> <span class="p">(</span><span class="n">rgba_ge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rgba_ge</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rgba_ge</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mf">0.6</span><span class="p">)</span>

<span class="n">rgba_vd</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="s2">&quot;lightseagreen&quot;</span><span class="p">)</span>
<span class="n">rgba_vd</span> <span class="o">=</span> <span class="p">(</span><span class="n">rgba_vd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rgba_vd</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rgba_vd</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># assign colors to VS and HS</span>
<span class="n">color_vs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;VS&quot;</span><span class="p">:</span><span class="s2">&quot;magenta&quot;</span><span class="p">,</span> <span class="s2">&quot;74&quot;</span><span class="p">:</span><span class="s2">&quot;dodgerblue&quot;</span><span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax4</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">priorg</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">boxprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;facecolor&quot;</span><span class="p">:</span><span class="n">rgba_ge</span><span class="p">})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">pSampsg</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">boxprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;facecolor&quot;</span><span class="p">:</span><span class="n">rgba_ge</span><span class="p">})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vs_hs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">color_vs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vs_hs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>  <span class="n">s</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">color_vs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">priorvd</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">boxprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;facecolor&quot;</span><span class="p">:</span><span class="n">rgba_vd</span><span class="p">})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">pSampsvd</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax4</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">boxprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;facecolor&quot;</span><span class="p">:</span><span class="n">rgba_vd</span><span class="p">})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vs_hs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>  <span class="n">s</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">color_vs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vs_hs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>  <span class="n">s</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">color_vs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax4</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Observé GE&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Prévisions GE&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Observé VD&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Prévisions VD&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>

<span class="n">h</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;VS&quot;</span><span class="p">,</span> <span class="s2">&quot;HS&quot;</span><span class="p">]</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>

<span class="k">for</span> <span class="n">anax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">]:</span>
    <span class="n">anax</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>

<span class="n">ax4</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Observés et prévus, total par événement (fragments et fibres)&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.98</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plstk_01_32_0.png" src="_images/plstk_01_32_0.png" />
</div>
</div>
</section>
<section id="pieces-par-metre-carre">
<span id="section-six"></span><h2>Pièces par mètre carré<a class="headerlink" href="#pieces-par-metre-carre" title="Permalink to this headline">#</a></h2>
<p>Chaque élément représente 100cm² de plage. Par conséquent, 100 échantillons sont égaux à 1m², la somme de ces échantillons est la quantité attendue par m².  La distribution prédictive postérieure a été échantillonnée 1 000 fois, à chaque fois la somme des 100 échantillons prédits a été calculée.</p>
<p>L’intervalle de densité maximale (IDM) de 94% (tous matériaux confondus) pour VD est de 9’112 - 12’174 pièces par m², pour GE de 6’447 - 8’707 pièces par m². Pris ensemble (VD + GE) la valeur attendue (94% HDI) par m² est de 6’505 11’836.</p>
<p>Ceci est significativement plus élevé que Faure 2014 et que les échantillons récents au Tessin.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># draw 100 samples 1000 times from each of the posterior preidcitive distributions</span>
<span class="n">some_samsVD</span><span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">pp_found_ravelvd</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1001</span><span class="p">)]</span>
<span class="n">some_samsGE</span><span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">pp_found_ravel</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1001</span><span class="p">)]</span>

<span class="c1"># get the HDO for each</span>
<span class="n">HDI_VD</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">hdi</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">some_samsVD</span><span class="p">))</span>
<span class="n">HDI_GE</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">hdi</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">some_samsGE</span><span class="p">))</span>
<span class="n">HDI_LAKE</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">hdi</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">*</span><span class="n">some_samsVD</span><span class="p">,</span> <span class="o">*</span><span class="n">some_samsGE</span><span class="p">]))</span>

<span class="c1"># draw 100 samples 1000 times from each of the observed distributions</span>
<span class="n">oVD</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">cData</span><span class="p">[</span><span class="n">cData</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;VD&quot;</span><span class="p">])]</span><span class="o">.</span><span class="n">total</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>
<span class="n">gVD</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">cData</span><span class="p">[</span><span class="n">cData</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;GE&quot;</span><span class="p">])]</span><span class="o">.</span><span class="n">total</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">gVD</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;pieces per m² observed GE&quot;</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">region_palette</span><span class="p">[</span><span class="s2">&quot;GE&quot;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">oVD</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;pieces per m² observed VD&quot;</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="n">region_palette</span><span class="p">[</span><span class="s2">&quot;VD&quot;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">some_samsGE</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;pieces per m² predicted GE&quot;</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">region_palette</span><span class="p">[</span><span class="s2">&quot;GE&quot;</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">some_samsVD</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;pieces per m² predicted VD&quot;</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">region_palette</span><span class="p">[</span><span class="s2">&quot;VD&quot;</span><span class="p">])</span>

<span class="n">l</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">h</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.02</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/plstk_01_34_0.png" src="_images/plstk_01_34_0.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Plastock - count data</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="plstk_02.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Un deuxième regard : effets du substrat, échantillonnage par région, données additionnelles, prévisions</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Association pour la Sauvegarde du Léman<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>